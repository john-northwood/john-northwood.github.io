<html>
<body>
<div id="container">   
    <button onclick="addDepot()" id="addDepot">Add Depot</button>
</div> 
<script>

let orals = [
  "Chlorpromazine",
  "Flupentixol",
  "Haloperidol",
  "Levomepromazine",
  "Pericyazine",
  "Perphenazine",
  "Pimozide",
  "Sulpiride",
  "Trifluoperizine",
  "Zuclopenthixol",
  "Amisulpride",
  "Aripiprazole",
  "Asenapine",
  "Clozapine",
  "Lurasidone HCL",
  "Lurasidone Base",
  "Olanzapine",
  "Paliperidone",
  "Quetiapine",
  "Quetiapine MR",
  "Risperidone",
  "Sertindole",
  "Brexipiprazole",
  "Cariprazine",
  "Iloperidone",
  "Molidone",
  "Ziprasidone"
];


let maxOralDosages = [
  1000,
  18,
  20,
  1000,
  300,
  24,
  20,
  2400,
  30,
  150,
  1200,
  30,
  20,
  900,
  160,
  148,
  20,
  12,
  750,
  800,
  16,
  24,
  4,
  6,
  24,
  225,
  160
];

let depots = [
  "Aripiprazole",
  "Flupentixol",
  "Fluphenazine",
  "Haloperidol",
  "Paliperidone",
  "Paliperidone 3M",
  "Pipotiazine",
  "Risperidone",
  "Zuclopenthixol",
  "Olanzapine"
];

let maxDepotDosages = [
  400,
  400,
  100,
  300,
  150,
  525,
  200,
  50,
  600,
  300
];

let depotMaxTimings = [
  4,
  1,
  2,
  4,
  4,
  12,
  4,
  2,
  1,
  2
];

let depotTimingDivisor = [
	1,
  2,
  4,
  12
];

let timings = ["1 Week", "2 Weeks", "4 Weeks", "12 Weeks"];


var div = document.querySelector("#container"),
    frag = document.createDocumentFragment(),
    perscriptionSelection = document.createElement("select");
    
var timingsSelection = document.createElement("select");
var dosageText = document.createElement("input");


for(let i = 0; i < depots.length; i++)
{
	let depot = depots[i];
  perscriptionSelection.options.add(new Option(depot)); 
}

for (let i = 0; i<timings.length; ++i)
{
	let timing = timings[i];
  timingsSelection.options.add(new Option(timing));
}

var label = document.createElement("Label");
label.innerHTML = "Dosage:";     

//Assign different attributes to the element.
dosageText.setAttribute("type", "text");
dosageText.setAttribute("value", "");
dosageText.setAttribute("name", "Test Name");
dosageText.setAttribute("style", "width:40px");

label.setAttribute("style", "font-weight:normal");

var addDepotBtn = document.createElement("button");
addDepotBtn.appendChild(document.createTextNode("Add Depot"));
addDepotBtn.setAttribute("onclick", alert("clicked"));


frag.appendChild(perscriptionSelection);
frag.appendChild(timingsSelection);
frag.appendChild(label);
frag.appendChild(dosageText);
frag.appendChild(addDepotBtn);
div.appendChild(frag);

function addDepot() 
{
	let dosage = parseInt(dosageText.value);
  if (Number.isInteger(dosage) == false || dosage <= 0)
  {
  	alert("Invalid dosage");
    return;
	}
  
  let index = perscriptionSelection.selectedIndex;
  let maxDosage = maxDepotDosages[index];
  
  let maxTiming = depotMaxTimings[index] * 7;
  
  let daysIndex = timingsSelection.selectedIndex;
  let days = depotTimingDivisor[daysIndex] * 7;
  
  let bnf = (dosage / (days/maxTiming)) / maxDosage;
  
  alert("bnf=" + bnf);
	//salert();
}




</script>
</body>
</html>
